<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GPT</title>

<style>
/* FORCE DARK MODE EVERYWHERE */
html, body {
  background-color:#0b0f14 !important;
  color:#e6edf3 !important;
}

:root { color-scheme: dark; }

* { box-sizing: border-box; }

body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
}

.wrap{
  max-width:900px;
  margin:40px auto;
  padding:0 18px;
}

.card{
  background:#0f1621 !important;
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px;
  padding:16px;
}

/* INPUTS */
input, textarea, button{
  width:100%;
  background:#0b0f14 !important;
  color:#e6edf3 !important;
  border:1px solid rgba(255,255,255,.12);
  border-radius:12px;
  padding:12px;
  font-size:14px;
  outline:none;
}

input::placeholder, textarea::placeholder{
  color:#8b98a5;
}

/* CHROME AUTOFILL FIX */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus{
  -webkit-box-shadow: 0 0 0 1000px #0b0f14 inset !important;
  -webkit-text-fill-color: #e6edf3 !important;
}

button{
  cursor:pointer;
  font-weight:600;
  margin-top:10px;
}

button:hover{
  border-color: rgba(140,180,255,.45);
}

pre{
  margin-top:12px;
  background:#0b0f14 !important;
  border:1px solid rgba(255,255,255,.08);
  border-radius:12px;
  padding:14px;
  white-space:pre-wrap;
  line-height:1.5;
  min-height:120px;
  font-size:14px;
}

.hidden{ display:none; }
</style>
</head>

<body>
<div class="wrap">

  <!-- PASSWORD GATE -->
  <div id="login" class="card">
    <input id="pw" type="password" placeholder="Password" />
    <button onclick="unlock()">Enter</button>
    <pre id="pwmsg"></pre>
  </div>

  <!-- APP -->
  <div id="app" class="card hidden">
    <textarea id="prompt" placeholder="Type here..."></textarea>
    <button id="sendBtn">Send</button>
    <pre id="response"></pre>
  </div>

</div>

<script>
  // PASSWORD (case-sensitive)
  const PASSWORD = "Gage626";

  function unlock(){
    const entered = document.getElementById("pw").value.trim();
    if (entered === PASSWORD){
      document.getElementById("login").classList.add("hidden");
      document.getElementById("app").classList.remove("hidden");
    } else {
      document.getElementById("pwmsg").textContent = "Incorrect password";
    }
  }

  const btn = document.getElementById("sendBtn");
  const out = document.getElementById("response");

  btn.addEventListener("click", async () => {
    out.textContent = "â€¦";
    try {
      const res = await fetch("/api/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          prompt: document.getElementById("prompt").value
        })
      });

      const raw = await res.text();
      if (!res.ok){
        out.textContent = raw;
        return;
      }

      out.textContent = JSON.parse(raw).reply ?? "(no response)";
    } catch (e){
      out.textContent = "ERROR: " + e;
    }
  });

  // Cmd/Ctrl + Enter to send
  document.getElementById("prompt").addEventListener("keydown", e => {
    if ((e.metaKey || e.ctrlKey) && e.key === "Enter") btn.click();
  });
</script>
</body>
</html>
