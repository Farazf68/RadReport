<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GPT</title>

<style>
html, body {
  background:#0b0f14 !important;
  color:#e6edf3 !important;
  margin:0;
}

:root { color-scheme: dark; }

* { box-sizing:border-box; }

body{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
}

.wrap{
  max-width:900px;
  margin:40px auto;
  padding:0 18px;
}

.card{
  background:#0f1621 !important;
  border:1px solid rgba(255,255,255,.08);
  border-radius:14px;
  padding:16px;
}

input, textarea, button{
  width:100%;
  background:#0b0f14 !important;
  color:#e6edf3 !important;
  border:1px solid rgba(255,255,255,.12);
  border-radius:12px;
  padding:12px;
  font-size:14px;
  outline:none;
}

button{
  margin-top:10px;
  cursor:pointer;
  font-weight:600;
}

pre{
  margin-top:12px;
  background:#0b0f14 !important;
  border:1px solid rgba(255,255,255,.08);
  border-radius:12px;
  padding:14px;
  white-space:pre-wrap;
  font-size:13px;
}

.hidden{ display:none; }
</style>
</head>

<body>
<div class="wrap">

  <!-- LOGIN -->
  <div id="login" class="card">
    <input id="pw" type="password" placeholder="Password" autocomplete="off" />
    <button onclick="unlock()">Enter</button>
    <pre id="pwmsg">Waiting for input…</pre>
  </div>

  <!-- APP -->
  <div id="app" class="card hidden">
    <textarea id="prompt" placeholder="Type here..."></textarea>
    <button id="sendBtn">Send</button>
    <pre id="response"></pre>
  </div>

</div>

<script>
  // PASSWORD
  const PASSWORD = "Gage626";

  function unlock(){
    const raw = document.getElementById("pw").value;
    const trimmed = raw.trim();

    // SHOW EXACT INPUT (DEBUG)
    document.getElementById("pwmsg").textContent =
      `RAW: "${raw}" (len=${raw.length})
TRIMMED: "${trimmed}" (len=${trimmed.length})
EXPECTED: "${PASSWORD}" (len=${PASSWORD.length})`;

    if (trimmed === PASSWORD){
      document.getElementById("pwmsg").textContent += "\n\n✔ PASSWORD MATCH";
      document.getElementById("login").classList.add("hidden");
      document.getElementById("app").classList.remove("hidden");
    } else {
      document.getElementById("pwmsg").textContent += "\n\n✖ INCORRECT PASSWORD";
    }
  }

  const btn = document.getElementById("sendBtn");
  const out = document.getElementById("response");

  btn.addEventListener("click", async () => {
    out.textContent = "…";
    try {
      const res = await fetch("/api/chat", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({
          prompt: document.getElementById("prompt").value
        })
      });
      const raw = await res.text();
      if(!res.ok){ out.textContent = raw; return; }
      out.textContent = JSON.parse(raw).reply;
    } catch(e){
      out.textContent = "ERROR: " + e;
    }
  });
</script>
</body>
</html>
